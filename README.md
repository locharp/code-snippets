This has strayed from what it was meant to be.
The code are not written in optimal forms.
